# THIS IS AUTOGENERATED. DO NOT EDIT MANUALLY
version = 1
name = "worktree_env"

[setup]
script = '''
set -euo pipefail

# 메인(worktree list의 첫 항목) 경로 찾기
MAIN_ROOT="$(git worktree list --porcelain | awk '/^worktree /{print $2; exit}')"

if [ -z "${MAIN_ROOT:-}" ]; then
  echo "MAIN_ROOT not found"
  exit 1
fi

# .env.local symlink
if [ -f "$MAIN_ROOT/.env.local" ]; then
  ln -sfn "$MAIN_ROOT/.env.local" ".env.local"
  echo "linked .env.local -> $MAIN_ROOT/.env.local"
else
  echo "warning: $MAIN_ROOT/.env.local not found"
fi

# 의존성 설치
pnpm install

# 개발 서버 실행(백그라운드)
nohup pnpm dev > .codex-dev.log 2>&1 &
echo "pnpm dev started (log: .codex-dev.log)"

'''
